<!DOCTYPE html>
<html>
<head>
    <title>TTS Truyá»‡n Audio Pro</title>
    <style>
        body {
            background: #111;
            color: white;
            font-family: Arial;
            text-align: center;
        }
        textarea {
            width: 80%;
            height: 150px;
            background: #222;
            color: white;
        }
        input, select, button {
            padding: 8px;
            margin: 5px;
            background: #333;
            color: white;
            border: none;
        }
        button {
            background: #00c853;
            cursor: pointer;
        }
        audio {
            width: 80%;
            margin-top: 20px;
        }
        input[type=range] {
            width: 80%;
        }
    </style>
</head>
<body>

<h2>ðŸŽ§ TTS Truyá»‡n Audio Ultra</h2>

<form id="ttsForm">
    <textarea name="text" placeholder="DÃ¡n ná»™i dung truyá»‡n vÃ o Ä‘Ã¢y..."></textarea><br>

    <select name="voice">
        <option value="vi-VN-HoaiMyNeural">HoÃ i My (Ná»¯)</option>
        <option value="vi-VN-NamMinhNeural">Nam Minh (Nam)</option>
    </select><br>

    <label>Tá»‘c Ä‘á»™ (0.5 - 2.0)</label>
    <input type="number" name="speed" value="1.0" step="0.1" min="0.5" max="2.0"><br>

    <button type="submit">Táº¡o truyá»‡n & Preview</button>
</form>

<audio id="player" controls></audio>

<br><br>

<label>Báº¯t Ä‘áº§u nghe (giÃ¢y)</label><br>
<input type="range" id="startRange" value="0"><br>

<label>Káº¿t thÃºc nghe (giÃ¢y)</label><br>
<input type="range" id="endRange" value="0"><br>

<script>
const form = document.getElementById("ttsForm");
const player = document.getElementById("player");
const startRange = document.getElementById("startRange");
const endRange = document.getElementById("endRange");

form.onsubmit = async function(e){
    e.preventDefault();
    let formData = new FormData(this);

    let res = await fetch("/generate", {
        method: "POST",
        body: formData
    });

    let data = await res.json();
    player.src = data.file;

    player.onloadedmetadata = function(){
        startRange.max = player.duration;
        endRange.max = player.duration;
        endRange.value = player.duration;
    }
};

startRange.oninput = function(){
    player.currentTime = startRange.value;
};

endRange.oninput = function(){
    if(player.currentTime > endRange.value){
        player.currentTime = endRange.value;
    }
};

player.ontimeupdate = function(){
    if(player.currentTime >= endRange.value){
        player.pause();
    }
};
</script>

</body>
</html>

</html>
